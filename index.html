<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistem Pendataan Guru Sertifikasi</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">
  <div class="max-w-5xl mx-auto p-6">
    <h1 class="text-2xl font-bold mb-4 text-center text-blue-700">
      Sistem Pendataan Guru Sertifikasi Yayasan Fajar & Mutiara Insani
    </h1>

    <form id="guruForm" class="bg-white p-6 rounded-xl shadow-lg space-y-4">
      <div>
        <label class="block font-medium text-gray-700 mb-1">Status Sertifikasi</label>
        <select id="statusSertifikasi" required class="w-full border p-2 rounded">
          <option value="">Pilih Status</option>
          <option value="Sudah Sertifikasi">Sudah Sertifikasi / PPG</option>
          <option value="Belum Sertifikasi">Belum Sertifikasi</option>
        </select>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block font-medium text-gray-700 mb-1">Nama Lengkap</label>
          <input id="namaLengkap" type="text" class="w-full border p-2 rounded" required>
        </div>
        <div>
          <label class="block font-medium text-gray-700 mb-1">NRG (opsional)</label>
          <input id="nrg" type="text" class="w-full border p-2 rounded">
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div>
          <label class="block font-medium text-gray-700 mb-1">Tempat Lahir</label>
          <input id="tempatLahir" type="text" class="w-full border p-2 rounded" required>
        </div>
        <div>
          <label class="block font-medium text-gray-700 mb-1">Tanggal Lahir</label>
          <input id="tanggalLahir" type="date" class="w-full border p-2 rounded" required>
        </div>
        <div>
          <label class="block font-medium text-gray-700 mb-1">Jenis Kelamin</label>
          <select id="jenisKelamin" class="w-full border p-2 rounded" required>
            <option value="">Pilih</option>
            <option value="Laki-laki">Laki-laki</option>
            <option value="Perempuan">Perempuan</option>
          </select>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block font-medium text-gray-700 mb-1">Agama</label>
          <select id="agama" class="w-full border p-2 rounded" required>
            <option value="">Pilih</option>
            <option value="Islam">Islam</option>
            <option value="Kristen">Kristen</option>
            <option value="Katolik">Katolik</option>
            <option value="Hindu">Hindu</option>
            <option value="Buddha">Buddha</option>
            <option value="Konghucu">Konghucu</option>
          </select>
        </div>
        <div>
          <label class="block font-medium text-gray-700 mb-1">No. Telepon</label>
          <input id="noTelepon" type="tel" class="w-full border p-2 rounded" required>
        </div>
      </div>

      <div>
        <label class="block font-medium text-gray-700 mb-1">Alamat</label>
        <textarea id="alamat" rows="3" class="w-full border p-2 rounded" required></textarea>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block font-medium text-gray-700 mb-1">Status Kepegawaian</label>
          <select id="statusKepegawaian" class="w-full border p-2 rounded" required>
            <option value="">Pilih</option>
            <option value="PNS">PNS</option>
            <option value="PPPK">PPPK</option>
            <option value="GTT">GTT (Guru Tidak Tetap)</option>
            <option value="GTY">GTY (Guru Tetap Yayasan)</option>
            <option value="Honorer">Honorer</option>
          </select>
        </div>
        <div>
          <label class="block font-medium text-gray-700 mb-1">Nama Sekolah</label>
          <select id="namaSekolah" class="w-full border p-2 rounded" required>
            <option value="">Pilih Sekolah</option>
            <option value="SMP Fajar">SMP Fajar</option>
            <option value="SMK Fajar">SMK Fajar</option>
            <option value="SMK Mutiara Insani">SMK Mutiara Insani</option>
          </select>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block font-medium text-gray-700 mb-1">Bidang Studi S1</label>
          <input id="bidangStudiS1" type="text" class="w-full border p-2 rounded" required>
        </div>
        <div>
          <label class="block font-medium text-gray-700 mb-1">Mata Pelajaran di Sekolah</label>
          <input id="mapel" type="text" placeholder="Pisahkan dengan koma (mis: Informatika, TIK)" class="w-full border p-2 rounded" required>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block font-medium text-gray-700 mb-1">Email Belajar.id</label>
          <input id="emailBelajar" type="email" class="w-full border p-2 rounded">
        </div>
        <div>
          <label class="block font-medium text-gray-700 mb-1">Email Pribadi</label>
          <input id="emailPribadi" type="email" class="w-full border p-2 rounded">
        </div>
      </div>

      <div id="fieldSertifikasi" class="hidden bg-green-50 p-4 rounded">
        <h3 class="font-bold text-green-800 mb-2">Data Sertifikasi / PPG</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block font-medium text-gray-700 mb-1">Jenis Sertifikasi</label>
            <select id="jenisSertifikasi" class="w-full border p-2 rounded">
              <option value="">Pilih</option>
              <option value="PLPG">Pendidikan dan Latihan Profesi Guru (PLPG)</option>
              <option value="PPG">Pendidikan Profesi Guru (PPG)</option>
            </select>
          </div>
          <div>
            <label class="block font-medium text-gray-700 mb-1">Bidang Studi Sertifikasi</label>
            <input id="bidangSertifikasi" type="text" class="w-full border p-2 rounded">
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
          <div>
            <label class="block font-medium text-gray-700 mb-1">Tanggal Mulai Berlaku</label>
            <input id="tanggalMulaiBerlaku" type="date" class="w-full border p-2 rounded">
          </div>
          <div>
            <label class="block font-medium text-gray-700 mb-1">Nomor Peserta Sertifikasi / PLPG</label>
            <input id="nomorPeserta" type="text" class="w-full border p-2 rounded">
          </div>
        </div>
      </div>

      <div class="flex justify-end space-x-4 mt-4">
        <button type="reset" class="bg-gray-500 hover:bg-gray-600 text-white px-5 py-2 rounded">Reset</button>
        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded">Simpan ke Google Sheets</button>
      </div>
    </form>

    <div id="notif" class="hidden mt-4 text-center font-medium"></div>
  </div>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw9dq89Zb3lRx7QqhLMaJThD-gViADodqkbs94onpDwhq7474IATc6mRtnmbrEF2J71/exec";

    // Tampilkan / sembunyikan field sertifikasi
    document.getElementById("statusSertifikasi").addEventListener("change", function() {
      const field = document.getElementById("fieldSertifikasi");
      if (this.value === "Sudah Sertifikasi") field.classList.remove("hidden");
      else field.classList.add("hidden");
    });

    // Simpan data
    document.getElementById("guruForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const btn = e.submitter;
      btn.disabled = true;
      btn.innerText = "Menyimpan...";

      const data = {
        "Status Sertifikasi": document.getElementById("statusSertifikasi").value,
        "Nama Lengkap": document.getElementById("namaLengkap").value,
        "NRG": document.getElementById("nrg").value,
        "Tempat Lahir": document.getElementById("tempatLahir").value,
        "Tanggal Lahir": document.getElementById("tanggalLahir").value,
        "Jenis Kelamin": document.getElementById("jenisKelamin").value,
        "Agama": document.getElementById("agama").value,
        "No. Telepon": document.getElementById("noTelepon").value,
        "Alamat": document.getElementById("alamat").value,
        "Status Kepegawaian": document.getElementById("statusKepegawaian").value,
        "Nama Sekolah": document.getElementById("namaSekolah").value,
        "Bidang Studi S1": document.getElementById("bidangStudiS1").value,
        "Mata Pelajaran di Sekolah": document.getElementById("mapel").value,
        "Email Belajar.id": document.getElementById("emailBelajar").value,
        "Email Pribadi": document.getElementById("emailPribadi").value,
        "Jenis Sertifikasi": document.getElementById("jenisSertifikasi").value,
        "Bidang Studi Sertifikasi": document.getElementById("bidangSertifikasi").value,
        "Tanggal Mulai Berlaku": document.getElementById("tanggalMulaiBerlaku").value,
        "Nomor Peserta Sertifikasi/PLPG": document.getElementById("nomorPeserta").value,
        "Upload Dokumen Sertifikat": "",
        "Upload SK KBM": "",
        "Upload Surat Tugas": ""
      };

      try {
        const res = await fetch(SCRIPT_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });
        const result = await res.json();

        const notif = document.getElementById("notif");
        notif.classList.remove("hidden");
        notif.textContent = result.success ? "✅ Data berhasil disimpan ke Google Sheets!" : "❌ Gagal: " + result.error;
        notif.className = result.success ? "text-green-600 font-semibold mt-4" : "text-red-600 font-semibold mt-4";

        if (result.success) e.target.reset();
      } catch (err) {
        alert("Gagal menyimpan: " + err.message);
      } finally {
        btn.disabled = false;
        btn.innerText = "Simpan ke Google Sheets";
      }
    });
  </script>
</body>
</html>
